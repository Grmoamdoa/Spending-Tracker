:root{
  --bg:#0f1115;--card:#151922;--muted:#1a2030;--text:#e9eef8;--sub:#a9b4c6;--brand:#6ee7ff;--accent:#7ee787;--warn:#ffdd57;--danger:#ff6b6b;
  --shadow:0 8px 24px rgba(0,0,0,.35);
  --radius:18px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, "Apple Color Emoji","Segoe UI Emoji";background:var(--bg);color:var(--text)}
header{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,rgba(12,14,20,.9),rgba(12,14,20,.6) 70%,rgba(12,14,20,0));backdrop-filter:saturate(150%) blur(8px);padding:10px 12px 6px;border-bottom:1px solid rgba(255,255,255,.05)}
.row{display:flex;gap:8px;align-items:center}
.title{font-size:18px;font-weight:700;letter-spacing:.2px}
select, input[type="text"], input[type="number"], button, .btn{border:none;border-radius:14px;padding:12px 14px;background:var(--muted);color:var(--text);font-size:15px}
select:focus,input:focus,button:focus{outline:2px solid var(--brand)}
button.primary{background:linear-gradient(180deg,#3cc9ff,#1da9e7);color:#03121a;font-weight:700}
button.ghost{background:transparent;border:1px solid rgba(255,255,255,.12)}
button.warn{background:linear-gradient(180deg,#ffe083,#ffc14d);color:#2c2000}
button.danger{background:linear-gradient(180deg,#ff9d9d,#ff6b6b);color:#260000}
.container{padding:10px 12px 90px;max-width:900px;margin:0 auto}

/* Add Item */
.card{background:var(--card);border-radius:var(--radius);padding:12px;box-shadow:var(--shadow)}
.input-grid{display:grid;grid-template-columns:1fr 110px 44px;gap:8px}
.input-grid .photo-btn{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:var(--muted)}
.hint{color:var(--sub);font-size:12px}

/* Items grid */
.items{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:12px}
@media(min-width:720px){.items{grid-template-columns:repeat(3,minmax(0,1fr))}}
.item{background:var(--card);border-radius:16px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
.item .thumb{height:120px;background:#0b0e14 center/cover no-repeat}
.item .content{padding:10px}
.price{font-weight:800}
.meta{color:var(--sub);font-size:12px}
.item .actions{display:flex;gap:8px;padding:10px}
.chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.06);font-size:12px}

/* Bottom nav */
.nav{position:fixed;bottom:0;left:0;right:0;z-index:60;background:linear-gradient(180deg,rgba(12,14,20,0),rgba(12,14,20,.9));padding:8px 12px}
.nav .bar{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.nav button{padding:12px 8px;border-radius:14px;background:var(--muted);font-weight:600}

/* Pills */
.pill{display:inline-block;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:700}
.ok{background:rgba(126,231,135,.18);color:var(--accent)}
.watch{background:rgba(255,221,87,.18);color:var(--warn)}
.over{background:rgba(255,107,107,.18);color:var(--danger)}

/* Modals */
dialog{border:none;border-radius:18px;padding:0;background:var(--card);color:var(--text);box-shadow:var(--shadow);width:min(96vw,720px)}
dialog::backdrop{background:rgba(0,0,0,.45)}
.modal-head{padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between}
.modal-body{padding:12px 14px;max-height:70vh;overflow:auto}
.modal-foot{padding:12px 14px;border-top:1px solid rgba(255,255,255,.06);display:flex;gap:10px;justify-content:flex-end}
.list-row{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:12px;background:rgba(255,255,255,.04);margin:6px 0}

/* Gallery */
.gallery{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
@media(min-width:640px){.gallery{grid-template-columns:repeat(3,minmax(0,1fr))}}
.gcard{background:var(--muted);border-radius:14px;overflow:hidden}
.gcard .ph{height:140px;background:#0b0e14 center/cover no-repeat}
.gcard .gc{padding:10px}

/* Analytics */
.stats{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
@media(min-width:640px){.stats{grid-template-columns:repeat(4,minmax(0,1fr))}}
.stat{background:var(--muted);border-radius:14px;padding:12px}
.stat .h{font-size:12px;color:var(--sub)}
.stat .v{font-size:18px;font-weight:800}
#chart{width:100%;height:220px;background:var(--muted);border-radius:14px}

/* Utilities */
.space{height:6px}
.sr{position:absolute;left:-9999px}
.divider{height:1px;background:rgba(255,255,255,.08);margin:12px 0}

/* --- Mobile fit + overflow fixes --- */
html, body { max-width: 100%; overflow-x: hidden; }

header .row,
.row { flex-wrap: wrap; }            /* let controls wrap instead of overflowing */

.container {
  width: 100%;
  max-width: 640px;                  /* comfy phone width cap */
  margin: 0 auto;
  padding-left: 12px;
  padding-right: 12px;
  padding-bottom: calc(90px + env(safe-area-inset-bottom)); /* room for fixed bottom nav */
}

/* Inputs/buttons must be >=16px on iOS or Safari will zoom and break layout */
select, input[type="text"], input[type="number"], button, .btn {
  font-size: 16px;
  min-width: 0;                      /* allow shrinking inside flex/grid */
}

/* Header selects/buttons shouldnâ€™t force overflow */
#listSelect { min-width: 0; max-width: 60vw; }

/* Item input row should never push wider than viewport */
.input-grid {
  grid-template-columns: minmax(0,1fr) minmax(84px, 26vw) 44px;
}

/* Items grid: one column on small screens; grow as width allows */
.items { grid-template-columns: 1fr; }
@media (min-width: 480px) { .items { grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (min-width: 720px) { .items { grid-template-columns: repeat(3, minmax(0,1fr)); } }

/* Cards/charts/images must not overflow */
.card, .item, .stat, .gcard { width: 100%; }
img, canvas { max-width: 100%; height: auto; display: block; }
#chart { width: 100%; }

/* Fixed bottom nav with safe-area padding for iOS */
.nav { left: 0; right: 0; padding-bottom: calc(8px + env(safe-area-inset-bottom)); }
.nav .bar { grid-template-columns: repeat(4, minmax(0,1fr)); }

/* Dialogs: make sure they never exceed the viewport width */
dialog { width: min(96vw, 720px); }
